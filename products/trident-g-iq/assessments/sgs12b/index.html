<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>SgS-12 B – Short g Scale</title>
  <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
  <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
  <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    body {
      font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", "Roboto", "Oxygen",
        "Ubuntu", "Cantarell", "Fira Sans", "Droid Sans", "Helvetica Neue",
        sans-serif;
      -webkit-font-smoothing: antialiased;
      -moz-osx-font-smoothing: grayscale;
    }
  </style>
</head>
<body class="bg-gray-50">
  <div id="root"></div>

  <script type="text/babel">
    const { useState } = React;

    // -----------------------------
    // Item definitions – SgS-12 B
    // Matrix mapping (final):
    // q12047 → BM1 → B
    // q12053 → BM2 → C
    // q12045 → BM3 → E
    // q12048 → BM4 → D
    // q12055 → BM5 → D
    // -----------------------------
    const ITEMS = [
      // Matrix reasoning (BM1–BM5)
      {
        id: 'BM1',
        kind: 'matrix',
        stemImageUrl: './images/matrices/BM1.jpg',
        responseOptions: ['A', 'B', 'C', 'D', 'E', 'F', 'None of these', "I don't know"],
        // BM1: keyed option 2 (B) → index 1
        correctOptionIndex: 1,
      },
      {
        id: 'BM2',
        kind: 'matrix',
        stemImageUrl: './images/matrices/BM2.jpg',
        responseOptions: ['A', 'B', 'C', 'D', 'E', 'F', 'None of these', "I don't know"],
        // BM2: keyed option 3 (C) → index 2
        correctOptionIndex: 2,
      },
      {
        id: 'BM3',
        kind: 'matrix',
        stemImageUrl: './images/matrices/BM3.jpg',
        responseOptions: ['A', 'B', 'C', 'D', 'E', 'F', 'None of these', "I don't know"],
        // BM3: keyed option 5 (E) → index 4
        correctOptionIndex: 4,
      },
      {
        id: 'BM4',
        kind: 'matrix',
        stemImageUrl: './images/matrices/BM4.jpg',
        responseOptions: ['A', 'B', 'C', 'D', 'E', 'F', 'None of these', "I don't know"],
        // BM4: keyed option 4 (D) → index 3
        correctOptionIndex: 3,
      },
      {
        id: 'BM5',
        kind: 'matrix',
        stemImageUrl: './images/matrices/BM5.jpg',
        responseOptions: ['A', 'B', 'C', 'D', 'E', 'F', 'None of these', "I don't know"],
        // BM5: keyed option 4 (D) → index 3
        correctOptionIndex: 3,
      },

      // Verbal reasoning (BVR1–BVR3)
      {
        id: 'BVR1',
        kind: 'verbal',
        stemText: 'The opposite of a "stubborn" person is a "_____" person.',
        responseOptions: [
          'Flexible',
          'Passionate',
          'Mediocre',
          'Reserved',
          'Pigheaded',
          'Persistent',
          'None of these',
          "I don't know",
        ],
        // BVR1: keyed option 1 → index 0
        correctOptionIndex: 0,
      },
      {
        id: 'BVR2',
        kind: 'verbal',
        stemText:
          'Adam and Melissa went fly-fishing and caught a total of 32 salmon. Melissa caught three times as many salmon as Adam. How many salmon did Adam catch?',
        responseOptions: [
          '7',
          '8',
          '9',
          '10',
          '11',
          '12',
          'None of these',
          "I don't know",
        ],
        // BVR2: keyed option 2 → index 1
        correctOptionIndex: 1,
      },
      {
        id: 'BVR3',
        kind: 'verbal',
        stemText:
          'Please mark the word that does not match the other words: (1) Buenos Aires (2) Melbourne (3) Seattle (4) Cairo (5) Morocco (6) Milan',
        responseOptions: [
          'Buenos Aires',
          'Melbourne',
          'Seattle',
          'Cairo',
          'Morocco',
          'Milan',
          'None of these',
          "I don't know",
        ],
        // BVR3: keyed option 5 (Morocco) → index 4
        correctOptionIndex: 4,
      },

      // Series reasoning (BSR1–BSR2)
      {
        id: 'BSR1',
        kind: 'series',
        stemText:
          'In the following alphanumeric series, what letter comes next? I, J, L, O, S, ...',
        responseOptions: [
          'T',
          'U',
          'V',
          'X',
          'Y',
          'Z',
          'None of these',
          "I don't know",
        ],
        // BSR1: logical key is option 4 (X) → index 3
        correctOptionIndex: 3,
      },
      {
        id: 'BSR2',
        kind: 'series',
        stemText:
          'In the following alphanumeric series, what letter comes next? V, Q, M, J, H, ...',
        responseOptions: [
          'E',
          'F',
          'G',
          'H',
          'I',
          'J',
          'None of these',
          "I don't know",
        ],
        // BSR2: keyed option 3 (G) → index 2
        correctOptionIndex: 2,
      },

      // 3D rotation (BR1–BR2)
      {
        id: 'BR1',
        kind: 'rotation',
        stemImageUrl: './images/rotation/BR1.jpg',
        responseOptions: ['A', 'B', 'C', 'D', 'E', 'F', 'G', 'H'],
        // BR1: keyed option 7 (G) → index 6
        correctOptionIndex: 6,
      },
      {
        id: 'BR2',
        kind: 'rotation',
        stemImageUrl: './images/rotation/BR2.jpg',
        responseOptions: ['A', 'B', 'C', 'D', 'E', 'F', 'G', 'H'],
        // BR2: keyed option 3 (C) → index 2
        correctOptionIndex: 2,
      },
    ];

    // -----------------------------
    // Scoring functions (same as Form A)
    // -----------------------------
    function getBand(raw) {
      if (raw <= 3) return 'low';
      if (raw <= 7) return 'typical';
      if (raw <= 9) return 'high';
      return 'veryHigh';
    }

    function rsIq(raw) {
      const mean = 5.4;
      const sd = 1.6;
      return Math.round(100 + 15 * ((raw - mean) / sd));
    }

    function getBandLabel(band) {
      const labels = {
        low: 'Lower than typical range',
        typical: 'Typical range',
        high: 'Higher than typical range',
        veryHigh: 'Very high range',
      };
      return labels[band];
    }

    function getBandDescription(band) {
      const descriptions = {
        low: 'Your score falls below the typical adult range. This could reflect tiredness, anxiety, unfamiliarity with the test format, or genuine difficulty with abstract reasoning. Consider retaking the test under less stressful conditions if you suspect external factors affected your performance.',
        typical: 'Your score falls within the broad typical range. You demonstrate reasonable ability to spot patterns and solve novel problems. This is representative of many adults tested on this kind of task.',
        high: 'Your score is above average. You found the pattern puzzles fairly natural once the format became clear. You perform well on abstract reasoning tasks.',
        veryHigh: 'Your score is in the very high range, indicating strong abstract reasoning ability. At this level, small differences in raw scores are not particularly meaningful.',
      };
      return descriptions[band];
    }

    // -----------------------------
    // Start screen
    // -----------------------------
    function StartScreen({ onStart }) {
      return (
        <div className="min-h-screen bg-gradient-to-br from-blue-50 to-indigo-50 flex items-center justify-center p-4">
          <div className="bg-white rounded-lg shadow-lg p-8 max-w-2xl w-full">
            <h1 className="text-4xl font-bold text-gray-800 mb-4 text-center">
              Short g Scale – SgS-12 B
            </h1>
            <p className="text-gray-600 text-lg mb-8 text-center leading-relaxed">
              A 12-item reasoning snapshot measuring matrices, verbal, series and 3D rotation.
              There are no time limits, but most people finish in 5–10 minutes.
            </p>
            <button
              onClick={onStart}
              className="w-full bg-indigo-600 hover:bg-indigo-700 text-white font-semibold py-3 px-6 rounded-lg transition-colors"
            >
              Start test
            </button>
          </div>
        </div>
      );
    }

    // -----------------------------
    // Item screen
    // -----------------------------
    function ItemScreen({
      item,
      itemIndex,
      totalItems,
      selectedOption,
      onSelectOption,
      onNext,
      onPrev,
    }) {
      const isAnswered = selectedOption !== null;
      const isLast = itemIndex === totalItems - 1;

      return (
        <div className="min-h-screen bg-gray-50 p-4">
          <div className="max-w-3xl mx-auto">
            <div className="mb-6">
              <div className="text-sm text-gray-600 font-medium">
                Question {itemIndex + 1} of {totalItems}
              </div>
              <div className="w-full bg-gray-200 rounded-full h-2 mt-2">
                <div
                  className="bg-indigo-600 h-2 rounded-full transition-all duration-300"
                  style={{ width: `${((itemIndex + 1) / totalItems) * 100}%` }}
                ></div>
              </div>
            </div>

            <div className="bg-white rounded-lg shadow-md p-8 mb-6">
              {/* Stem */}
              {item.kind === 'matrix' || item.kind === 'rotation' ? (
                <div className="mb-8 text-center">
                  <img
                    src={item.stemImageUrl}
                    alt="Reasoning puzzle"
                    className="max-w-full h-auto mx-auto max-h-96 object-contain"
                  />
                </div>
              ) : (
                <p className="text-lg text-gray-700 mb-8 leading-relaxed">
                  {item.stemText}
                </p>
              )}

              {/* Response options */}
              <div className="grid grid-cols-2 gap-3 md:grid-cols-4">
                {item.responseOptions.map((option, idx) => (
                  <button
                    key={idx}
                    onClick={() => onSelectOption(idx)}
                    className={`py-3 px-4 rounded-lg font-medium transition-all ${
                      selectedOption === idx
                        ? 'bg-indigo-600 text-white shadow-md'
                        : 'bg-gray-100 text-gray-700 hover:bg-gray-200'
                    }`}
                  >
                    {option}
                  </button>
                ))}
              </div>
            </div>

            {/* Navigation */}
            <div className="flex gap-4">
              <button
                onClick={onPrev}
                disabled={itemIndex === 0}
                className="flex-1 py-3 px-4 bg-gray-300 text-gray-700 font-semibold rounded-lg hover:bg-gray-400 disabled:opacity-50 disabled:cursor-not-allowed transition-colors"
              >
                Previous
              </button>
              <button
                onClick={onNext}
                disabled={!isAnswered}
                className="flex-1 py-3 px-4 bg-indigo-600 text-white font-semibold rounded-lg hover:bg-indigo-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors"
              >
                {isLast ? 'See results' : 'Next'}
              </button>
            </div>
          </div>
        </div>
      );
    }

    // -----------------------------
    // Results screen
    // -----------------------------
    function ResultsScreen({ rawScore, onRestart }) {
      const band = getBand(rawScore);
      const bandLabel = getBandLabel(band);
      const description = getBandDescription(band);
      const iq = rsIq(rawScore);

      return (
        <div className="min-h-screen bg-gradient-to-br from-indigo-50 to-blue-50 p-4">
          <div className="max-w-2xl mx-auto">
            <div className="bg-white rounded-lg shadow-lg p-8 mb-6">
              <h2 className="text-3xl font-bold text-gray-800 mb-8 text-center">
                Your Results
              </h2>

              {/* Raw score */}
              <div className="bg-indigo-50 rounded-lg p-6 mb-8 text-center border-2 border-indigo-200">
                <div className="text-5xl font-bold text-indigo-600 mb-2">
                  {rawScore}
                </div>
                <div className="text-gray-600 font-medium">
                  Raw score (out of 12)
                </div>
              </div>

              {/* Band interpretation */}
              <div className="mb-8">
                <h3 className="text-xl font-bold text-gray-800 mb-3">
                  Score band: {bandLabel}
                </h3>
                <p className="text-gray-700 leading-relaxed">
                  {description}
                </p>
              </div>

              {/* RS-IQ */}
              <div className="bg-blue-50 rounded-lg p-6 mb-8 border-2 border-blue-200">
                <div className="text-center mb-4">
                  <div className="text-4xl font-bold text-blue-600 mb-1">
                    RS-IQ {iq}
                  </div>
                  <div className="text-gray-600 font-medium text-sm">
                    Reasoning Snapshot IQ-equivalent
                  </div>
                </div>
                <div className="text-xs text-gray-600 text-center mt-4 pt-4 border-t border-blue-200">
                  RS-IQ is an internal Reasoning Snapshot IQ-equivalent score, based on adult
                  internet-sample norms. It is not a clinical IQ score and should not be
                  interpreted as a WAIS score.
                </div>
              </div>

              {/* Correspondence guide */}
              <div className="bg-gray-50 rounded-lg p-6 mb-8">
                <h4 className="font-bold text-gray-800 mb-3">Typical score ranges:</h4>
                <div className="grid grid-cols-2 gap-4 text-sm">
                  <div className="text-gray-700">
                    <span className="font-semibold">0–3:</span> RS-IQ &lt; ~85
                  </div>
                  <div className="text-gray-700">
                    <span className="font-semibold">4–7:</span> ~85–115
                  </div>
                  <div className="text-gray-700">
                    <span className="font-semibold">8–9:</span> ~115–125
                  </div>
                  <div className="text-gray-700">
                    <span className="font-semibold">10–12:</span> 125+
                  </div>
                </div>
              </div>

              {/* Restart */}
              <button
                onClick={onRestart}
                className="w-full bg-indigo-600 hover:bg-indigo-700 text-white font-semibold py-3 px-6 rounded-lg transition-colors"
              >
                Restart test
              </button>
            </div>
          </div>
        </div>
      );
    }

    // -----------------------------
    // Main app – SgS-12 B
    // -----------------------------
    function SgS12BApp() {
      const [screen, setScreen] = useState('start'); // 'start', 'test', 'results'
      const [currentItemIndex, setCurrentItemIndex] = useState(0);
      const [answers, setAnswers] = useState(new Array(ITEMS.length).fill(null));

      const handleStart = () => {
        setScreen('test');
        setCurrentItemIndex(0);
        setAnswers(new Array(ITEMS.length).fill(null));
      };

      const handleSelectOption = (optionIndex) => {
        const newAnswers = [...answers];
        newAnswers[currentItemIndex] = optionIndex;
        setAnswers(newAnswers);
      };

      const handleNext = () => {
        if (currentItemIndex < ITEMS.length - 1) {
          setCurrentItemIndex(currentItemIndex + 1);
        } else {
          // End of test → show results
          setScreen('results');
        }
      };

      const handlePrev = () => {
        if (currentItemIndex > 0) {
          setCurrentItemIndex(currentItemIndex - 1);
        }
      };

      const handleRestart = () => {
        setScreen('start');
        setCurrentItemIndex(0);
        setAnswers(new Array(ITEMS.length).fill(null));
      };

      if (screen === 'start') {
        return <StartScreen onStart={handleStart} />;
      }

      if (screen === 'test') {
        const currentItem = ITEMS[currentItemIndex];
        return (
          <ItemScreen
            item={currentItem}
            itemIndex={currentItemIndex}
            totalItems={ITEMS.length}
            selectedOption={answers[currentItemIndex]}
            onSelectOption={handleSelectOption}
            onNext={handleNext}
            onPrev={handlePrev}
          />
        );
      }

      if (screen === 'results') {
        const rawScore = answers.reduce((sum, answer, idx) => {
          if (answer === ITEMS[idx].correctOptionIndex) {
            return sum + 1;
          }
          return sum;
        }, 0);
        return <ResultsScreen rawScore={rawScore} onRestart={handleRestart} />;
      }

      return null;
    }

    // Render app
    const root = ReactDOM.createRoot(document.getElementById('root'));
    root.render(<SgS12BApp />);
  </script>
</body>
</html>
